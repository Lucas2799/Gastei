<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Gastei.UI.Views.RelatoriosPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    BackgroundColor="#121212"
    Title="RelatÃ³rios">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="25">


            <!-- ðŸŸ£ HEADER PREMIUM -->
            <Frame Padding="25"
                   CornerRadius="20"
                   HasShadow="True">

                <Frame.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#6a11cb" Offset="0.0" />
                        <GradientStop Color="#2575fc" Offset="1.0" />
                    </LinearGradientBrush>
                </Frame.Background>

                <VerticalStackLayout Spacing="8" HorizontalOptions="Center">

                    <!--<Image Source="report.png"
                           HeightRequest="60"
                           Margin="0,0,0,10"/>-->

                    <Label Text="RelatÃ³rios"
                           TextColor="White"
                           FontSize="28"
                           FontAttributes="Bold"
                           HorizontalTextAlignment="Center"/>

                    <Label Text="AnÃ¡lises completas do seu orÃ§amento"
                           TextColor="#EEEEEE"
                           FontSize="14"/>
                </VerticalStackLayout>
            </Frame>



            <!-- ðŸ”Ž FILTROS -->
            <Frame BackgroundColor="#1E1E1E" CornerRadius="14" Padding="18" HasShadow="True">
                <VerticalStackLayout Spacing="20">

                    <Label Text="Filtros"
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="White"/>

                    <HorizontalStackLayout Spacing="15">

                        <VerticalStackLayout>
                            <Label Text="MÃªs" TextColor="#AAA" FontSize="12"/>
                            <Picker Title="Selecione"
                                    TextColor="White"
                                    TitleColor="#777"
                                    ItemsSource="{Binding Meses}"
                                    SelectedItem="{Binding MesSelecionado}"
                                    BackgroundColor="#292929"
                                    WidthRequest="150" />
                        </VerticalStackLayout>

                        <VerticalStackLayout>
                            <Label Text="Ano" TextColor="#AAA" FontSize="12"/>
                            <Picker Title="Selecione"
                                    TextColor="White"
                                    TitleColor="#777"
                                    ItemsSource="{Binding Anos}"
                                    SelectedItem="{Binding AnoSelecionado}"
                                    BackgroundColor="#292929"
                                    WidthRequest="120"/>
                        </VerticalStackLayout>

                    </HorizontalStackLayout>

                    <Button Text="ðŸ”„ Atualizar"
                            Command="{Binding CarregarTudoCommand}"
                            BackgroundColor="#6a11cb"
                            TextColor="White"
                            CornerRadius="10"
                            HeightRequest="48"
                            FontAttributes="Bold"/>

                </VerticalStackLayout>
            </Frame>



            <!-- ðŸ“‰ TENDÃŠNCIA DE GASTOS -->
            <Frame BackgroundColor="#1E1E1E" CornerRadius="14" Padding="18">
                <VerticalStackLayout Spacing="15">

                    <Label Text="TendÃªncia de Gastos (Ãšltimos Meses)"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="White"/>

                    <CollectionView ItemsSource="{Binding GraficoTendencia}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <VerticalStackLayout Padding="5,8">

                                    <Label Text="{Binding MesAno}"
                                           FontSize="15"
                                           TextColor="#DDD"/>

                                    <Border BackgroundColor="#4CAF50"
                                            StrokeThickness="0"
                                            StrokeShape="RoundRectangle 4"
                                            HeightRequest="8"
                                            WidthRequest="{Binding Valor}"/>
                                </VerticalStackLayout>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Frame>



            <!-- ðŸ“ˆ CRESCIMENTO POR CATEGORIA -->
            <Frame BackgroundColor="#1E1E1E" CornerRadius="14" Padding="18">
                <VerticalStackLayout Spacing="15">

                    <Label Text="Crescimento por Categoria"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="White"/>

                    <CollectionView ItemsSource="{Binding CrescimentoCategorias}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10" ColumnDefinitions="*,Auto">

                                    <Label Text="{Binding Categoria}"
                                           FontSize="15"
                                           TextColor="White"/>

                                    <Label Text="{Binding CrescimentoPercentual, StringFormat='{0}%'}"
                                           FontAttributes="Bold"
                                           TextColor="#4CAF50"
                                           FontSize="15"
                                           Grid.Column="1"/>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Frame>



            <!-- ðŸ”„ DISTRIBUIÃ‡ÃƒO REAL vs IDEAL -->
            <Frame BackgroundColor="#1E1E1E" CornerRadius="14" Padding="18">
                <VerticalStackLayout Spacing="15">

                    <Label Text="DistribuiÃ§Ã£o (Real x Ideal)"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="White"/>

                    <CollectionView ItemsSource="{Binding DistribuicaoCategorias}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10"
                                      ColumnDefinitions="*,Auto,Auto">

                                    <Label Text="{Binding Categoria}"
                                           TextColor="White"
                                           FontSize="15"/>

                                    <Label Text="{Binding RealPercent, StringFormat='{0:P0}'}"
                                           TextColor="#4CAF50"
                                           FontAttributes="Bold"
                                           Grid.Column="1"/>

                                    <Label Text="{Binding IdealPercent, StringFormat='{0:P0}'}"
                                           TextColor="#BBB"
                                           Grid.Column="2"
                                           Margin="20,0,0,0"/>

                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Frame>



            <!-- ðŸ¥‡ RANKING DE GASTOS -->
            <Frame BackgroundColor="#1E1E1E" CornerRadius="14" Padding="18">
                <VerticalStackLayout Spacing="15">

                    <Label Text="Ranking de Gastos"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="White"/>

                    <CollectionView ItemsSource="{Binding RankingCategorias}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid Padding="10"
                                      ColumnDefinitions="Auto,*,Auto">

                                    <Label Text="{Binding Posicao}"
                                           TextColor="#AAA"/>

                                    <Label Text="{Binding Categoria}"
                                           Grid.Column="1"
                                           TextColor="White"
                                           Margin="10,0"/>

                                    <Label Text="{Binding Valor, StringFormat='R$ {0:F2}'}"
                                           TextColor="White"
                                           FontAttributes="Bold"
                                           Grid.Column="2"/>

                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Frame>



            <!-- âš ï¸ ALERTAS -->
            <Frame BackgroundColor="#1E1E1E" CornerRadius="14" Padding="18">
                <VerticalStackLayout Spacing="15">

                    <Label Text="Alertas"
                           FontSize="18"
                           FontAttributes="Bold"
                           TextColor="White"/>

                    <CollectionView ItemsSource="{Binding Alertas}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Frame BackgroundColor="#3A2A2A"
                                       CornerRadius="10"
                                       Padding="12"
                                       Margin="0,5">

                                    <Label Text="{Binding}"
                                           TextColor="Orange"
                                           FontSize="14"/>
                                </Frame>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                </VerticalStackLayout>
            </Frame>



            <!-- ðŸ“… RESUMO ANUAL -->
            <Frame BackgroundColor="#1E1E1E" CornerRadius="14" Padding="18">
                <VerticalStackLayout Spacing="10">

                    <Label Text="Resumo Anual"
                           TextColor="White"
                           FontSize="18"
                           FontAttributes="Bold"/>

                    <Label Text="{Binding TotalAno, StringFormat='Total: R$ {0:F2}'}"
                           TextColor="#DDD"/>

                    <Label Text="{Binding MesMaisCaro}"
                           TextColor="White"/>

                    <Label Text="{Binding MesMaisBarato}"
                           TextColor="White"/>

                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
